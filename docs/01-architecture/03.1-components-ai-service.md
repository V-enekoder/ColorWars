@startuml
!theme plain
skinparam componentStyle uml2
' Esta instrucción fuerza el diseño horizontal (Izquierda a Derecha)
left to right direction

title Diagrama de Componentes Abstracto - AI Service Core

' ==========================================
' ZONA IZQUIERDA: CONDUCTORES (DRIVERS)
' Quien inicia la petición
' ==========================================
package "Primary Adapters (Drivers)" {
    component [API Controller] as API
    note bottom of API: HTTP / REST
}

' ==========================================
' ZONA CENTRAL: EL HEXÁGONO (DOMINIO)
' Lógica pura y abstracciones
' ==========================================
rectangle "Hexagon (Core Domain)" {
    
    ' Puerto de Entrada (Al borde izquierdo del hexágono)
    interface "Input Port\n(IAgent)" as IInput
    
    ' Lógica de Negocio (Centro)
    ' "collections" indica que hay varias (Minimax, PPO, etc.)
    collections "Strategies\n(Business Logic)" as Strategies
    
    ' Puertos de Salida (Al borde derecho del hexágono)
    interface "Output Port\n(IGameEngine)" as IEnginePort
    interface "Output Port\n(IRepository)" as IRepoPort
}

' ==========================================
' ZONA DERECHA: INFRAESTRUCTURA (DRIVEN)
' Herramientas que el dominio necesita
' ==========================================
package "Secondary Adapters (Driven)" {
    component [Calculation Engine] as EngineImpl
    component [Persistence Adapter] as DBImpl
    
    note bottom of EngineImpl: Implementación técnica\n(ej. Rust / Bitboards)
}

' ==========================================
' RELACIONES Y FLUJO
' ==========================================

' 1. Entrada: El API usa la interfaz de entrada
API --> IInput : " 1. Uses"

' 2. Conexión Interna: Las Estrategias implementan la entrada
' (La flecha punteada significa 'implements')
Strategies .up.|> IInput

' 3. Uso Interno: Las Estrategias usan las interfaces de salida
Strategies --> IEnginePort : " 2. Simulates with"
Strategies --> IRepoPort : " 3. Persists to"

' 4. Salida: La infraestructura implementa las interfaces de salida
' (Inversión de dependencias: La flecha va de la infraestructura hacia el dominio)
EngineImpl .up.|> IEnginePort
DBImpl .up.|> IRepoPort

@enduml
